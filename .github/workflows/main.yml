name: Auto Weather Scraper

# 設定執行時機
on:
  schedule:
    # 每 12 小時執行一次 (UTC 時間，台灣時間要+8)
    # 這裡設定為 UTC 00:00 和 12:00 (即台灣時間 08:00 和 20:00)
    - cron: '0 0,12 * * *'
  # 允許手動點擊按鈕執行 (方便測試)
  workflow_dispatch:

jobs:
  scrape:
    runs-on: ubuntu-latest # 使用 GitHub 提供的最新 Linux 虛擬機

    steps:
      # 1. 把你的程式碼下載到虛擬機
      - name: Checkout code
        uses: actions/checkout@v3

      # 2. 設定 Python 環境
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      # 3. 安裝 Python 套件 (取代你的 !pip install)
      - name: Install dependencies
        run: |
          pip install -r requirements.txt

      # 4. 執行爬蟲程式
      - name: Run Scraper
        run: python main.py

      # 5. 保存結果 (Artifacts)
      # 因為虛擬機跑完就會銷毀，我們要把產生的 CSV 上傳保存下來
      - name: Upload CSV Artifact
        uses: actions/upload-artifact@v4
        with:
          name: weather-data
          path: "*.csv"
          retention-days: 10
